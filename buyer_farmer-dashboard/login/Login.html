<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgriFarm - Login</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="Login.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    .password-box { position: relative; }
    .toggle-password {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #ff0000;
      font-weight: 600;
      cursor: pointer;
      padding: 4px 6px;
    }
  </style>
</head>

<body> 

  <div class="container" id="login-form">
    <div class="curved-shape"></div>
    <div class="form-box Login">
      <h2><i class="fas fa-seedling"></i> AgriFarm</h2>
      <p class="subtitle">Welcome back to our farming community</p>

      <form id="loginForm" action="login.php" method="post" novalidate>
        <div class="input-box">
          <input type="email" id="email" name="email" required>
          <label for="email"><i class="fas fa-envelope"></i> Email</label>
          <div class="error" id="emailError" aria-live="polite"></div>
        </div>

        <div class="input-box password-box">
          <input type="password" id="password" name="password" required>
          <label for="password"><i class="fas fa-lock"></i> Password</label>
          <button type="button" class="toggle-password" data-target="password" aria-label="Show password">
            <i class="fas fa-eye"></i>
          </button>
          <div class="error" id="passwordError" aria-live="polite"></div>
        </div>

        <div class="input-box" style="text-align: right; margin-bottom: 10px;">
          <a href="forgot_password.php" style="color: #ff0000; text-decoration: none; font-size: 14px;">
            <i class="fas fa-key"></i> Forgot Password?
          </a>
        </div>

        <div class="input-box">
          <button class="btn" type="submit">
            <i class="fas fa-sign-in-alt"></i> Login
          </button>
        </div>
        <br>

        <div class="regi-link">
          <p>Don't have an account? <a href="Registration.html"><i class="fas fa-user-plus"></i> Sign Up</a></p>
        </div>
      </form>
    </div>
    <div class="info-content Login">
      <h2><i class="fas fa-tractor"></i> Welcome Back!</h2>
      <p class="info-text">Continue your journey in sustainable farming and community building.</p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.getElementById('loginForm');
      const email = document.getElementById('email');
      const password = document.getElementById('password');
      const emailError = document.getElementById('emailError');
      const passwordError = document.getElementById('passwordError');

      email.addEventListener('input', validateEmail);
      password.addEventListener('input', validatePassword);

      function showError(element, message) {
        element.textContent = message;
        element.classList.add('show');
        const input = element.parentElement.querySelector('input');
        if (input) {
          input.classList.add('invalid');
          input.classList.remove('valid');
        }
      }

      function showSuccess(element) {
        element.textContent = '';
        element.classList.remove('show');
        const input = element.parentElement.querySelector('input');
        if (input) {
          input.classList.add('valid');
          input.classList.remove('invalid');
        }
      }

      function validateEmail() {
        const value = email.value.trim();
        if (value === '') {
          showError(emailError, 'Email is required.');
          return false;
        } else {
          // Basic email validation
          const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value);
          if (!ok) {
            showError(emailError, 'Please enter a valid email address.');
            return false;
          }
        }
        showSuccess(emailError);
        return true;
      }

      function validatePassword() {
        const value = password.value.trim();
        if (value === '') {
          showError(passwordError, 'Password is required');
          return false;
        } else if (value.length < 8) {
          showError(passwordError, 'Password must be at least 8 characters');
          return false;
        } else if (!/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(value)) {
          showError(passwordError, 'Password must contain uppercase, lowercase, and number');
          return false;
        } else {
          showSuccess(passwordError);
          return true;
        }
      }

      form.addEventListener('submit', function (e) {
        e.preventDefault();

        const isEmailValid = validateEmail();
        const isPasswordValid = validatePassword();

        if (isEmailValid && isPasswordValid) {
          form.submit();
        }
      });

      const formElements = document.querySelectorAll('.input-box');
      formElements.forEach((element, index) => {
        element.style.animationDelay = `${index * 0.1}s`;
        element.classList.add('fade-in');
      });

      // Toggle password visibility (icon)
      document.querySelectorAll('.toggle-password').forEach((btn) => {
        const target = document.getElementById(btn.dataset.target);
        const icon = btn.querySelector('i');
        if (!target || !icon) return;

        btn.addEventListener('click', () => {
          const isVisible = target.type === 'text';
          target.type = isVisible ? 'password' : 'text';

          // Toggle eye / eye-slash icon
          icon.classList.toggle('fa-eye', !isVisible);
          icon.classList.toggle('fa-eye-slash', isVisible);

          // Optional: change color when visible
          btn.style.color = isVisible ? '#ff0000' : '#28a745';

          btn.setAttribute('aria-label', isVisible ? 'Show password' : 'Hide password');
        });
      });
    });
  </script>
</body>
</html>
